## Подключение ИК приемника и настройка пульта  

Большей частью как подключить инфракрасный приемник к Raspberry PI пишут вот тут -> http://www.avislab.com/blog/raspberry-ir_ru/  

Что к ней стоит добавить из моего личного опыта:
1. Чтобы проверить что ты все правильно подсоединил, что ИК приемник и пульт работают, одновременно устранив вариант что ты неправильно настроил LIRC стоит использовать такой инструмент как `piscope` (это GUI тулза, которая позволяет слушать появляется ли напряжение на пинах). Если, когда ты нажимаешь на пульт ДУ на пине, по которому должны идти данные, появляется напряжение — все нормально. Я советую вообще начинать с этого, сделать это еще до установки LIRC.  

2. Когда я записывал конфиг для пульта (посредством `irrecord`). То в файле `lircd.conf` который мне сгенерировал тот самый `irrecord`, было два столбца кодов для каждой кнопки. Из-за этого `irw` не интерпретировал сигналы с пульта как какие-то конкретные кнопки. Когда я удалилть второй столбец — все стало работать как надо. В консоль `irw` стал писать те кнопки, на которые я нажимаю.

## Как подружить сигналы, приходящие с пульта, с командами omxplayer  

Я решил эту проблему посредством d-bus, который omxplayer слушает и даже имеет bash скрипт, который можно дергать с определенными параметрами (абстракция над более низкоуровневыми командами в d-bus).
Последовательность шагов следующая:  

1. Клонируем файл `dbuscontrol.sh` из официального репозитория [omxplayer](https://github.com/popcornmix/omxplayer/blob/master/dbuscontrol.sh)
2. Запихиваем его в `/usr/local/bin`
3. Проставляем ему права на выполение `chmod +rx`
4. В `.lircrc` обращаемся к нему как `dbuscontrol.sh pause` (эта команда поставит воспроизводимый файл в omxplayer на паузу, остальные команды - в официальном репозитории omxplayer в README)
5. Что еще важно: мне пришлось в своем скрипте `main.py` поменять вызов omxplayer-а с использования модуля `subprocess` на простой вызов `os.system`. Потому что в подпроцессе omxplayer не создавал временные файлы, которые необходмы для работы через d-bus (`/tmp/omxplayerdbus.${USER:-root}`, `/tmp/omxplayerdbus.${USER:-root}.pid`).

**Примеры некоторых конфигурационных файлов лежат в папке config-examples**

## Запуск слушателя ИК приемника при старте системы
Я положил команду `irexec &` в `~/.bashrc` ДО запуска `main.py`. Эта команда необходима чтобы стартануть демона, который будет следить за приходящими от пульта сигналами.